<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
  <title>VEROOM | ØºØ±ÙØ© Ø§Ù„Ù†Ø¸Ø§Ø±Ø§Øª 3D</title>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;800;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="assets/style.css">
  <style>
    body{font-family:"Cairo",system-ui,-apple-system,"Segoe UI",Roboto,Arial}
    .wrap{display:grid;grid-template-columns:1fr 420px;gap:14px;margin-top:14px}
    .viewerCard{min-height:720px;position:relative;overflow:hidden;border-radius:22px}
    canvas{position:absolute;inset:0;width:100%;height:100%}
    .hud{position:absolute;top:12px;left:12px;right:12px;display:flex;justify-content:space-between;gap:10px;z-index:3}
    .hud2{position:absolute;bottom:12px;left:12px;right:12px;display:flex;gap:10px;flex-wrap:wrap;z-index:3}
    .chip{padding:9px 10px;border-radius:16px;border:1px solid var(--line);background:rgba(255,255,255,.84);font-weight:1000;font-size:12px;display:flex;gap:8px;align-items:center;box-shadow: 0 10px 25px rgba(15,23,42,.06)}
    .chip b{color:var(--p1)}
    .colors{display:grid;grid-template-columns:repeat(6,1fr);gap:10px}
    .cbtn{height:38px;border-radius:14px;border:1px solid var(--line);background:white;cursor:pointer;position:relative;overflow:hidden}
    .cbtn::before{content:"";position:absolute;inset:7px;border-radius:10px;background:var(--c);box-shadow:inset 0 0 0 1px rgba(0,0,0,.10)}
    .cbtn.active{border-color:rgba(77,163,255,.68)}
    .range{width:100%}
    .note{padding:12px;border-radius:18px;border:1px dashed rgba(77,163,255,.55);background:rgba(77,163,255,.08);font-weight:900;color:rgba(11,27,43,.72);line-height:1.7}
    @media (max-width:1020px){.wrap{grid-template-columns:1fr}.viewerCard{min-height:620px}}
  </style>
</head>
<body>
  <div class="topbar">
    <div class="container nav">
      <div class="brand">
        <div class="vmark"><span>V</span></div>
        <div>
          <div style="font-size:14px;line-height:1;font-weight:1000">VEROOM</div>
          <div class="kicker">ØºØ±ÙØ© ØªØ¬Ø±Ø¨Ø© Ø§Ù„Ù†Ø¸Ø§Ø±Ø§Øª â€¢ 3D WebGL</div>
        </div>
      </div>
      <div class="btnRow">
        <a class="pill" href="index.html">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
        <a class="pill" href="store-eyewear.html">Ø§Ù„Ù…ØªØ¬Ø±</a>
        <span class="pill primary" id="cartBtn">Ø§Ù„Ø³Ù„Ø© <span class="badge" id="cartCount">0</span></span>
      </div>
    </div>
  </div>

  <main class="container">
    <section class="hero">
      <div class="bg"></div>
      <div class="content">
        <div>
          <h1>ØºØ±ÙØ© ØªØ¬Ø±Ø¨Ø© Ø§Ù„Ù†Ø¸Ø§Ø±Ø§Øª 3D</h1>
          <p>Ø§Ø³Ø­Ø¨ Ù„Ù„Ø¯ÙˆØ±Ø§Ù† 360Â° â€¢ Ù‚Ø±Ù‘Ø¨/Ø¨Ø¹Ù‘Ø¯ Ø¨Ø¹Ø¬Ù„Ø© Ø§Ù„Ù…Ø§ÙˆØ³ Ø£Ùˆ Ø¨Ø¥ÙŠÙ…Ø§Ø¡Ø© Ø§Ù„Ø¥ØµØ¨Ø¹ÙŠÙ† Ø¹Ù„Ù‰ Ø§Ù„Ø¬ÙˆØ§Ù„ â€¢ ØºÙŠÙ‘Ø± Ù„ÙˆÙ† Ø§Ù„Ø¥Ø·Ø§Ø± â€¢ Ø£Ø¶Ù Ù„Ù„Ø³Ù„Ø©.</p>
        </div>
        <div class="btnRow">
          <button class="btn primary" id="autoSpin">ØªØ´ØºÙŠÙ„/Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø¯ÙˆØ±Ø§Ù†</button>
          <button class="btn" id="reset">Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø·</button>
          <button class="btn" id="snap">ğŸ“¸ Ø­ÙØ¸ Ù„Ù‚Ø·Ø©</button>
        </div>
      </div>
    </section>

    <section class="wrap">
      <div class="card viewerCard" id="viewer">
        <div class="hud">
          <div class="chip">Ø§Ù„Ù…Ù†ØªØ¬: <b id="name">â€”</b></div>
          <div class="chip">Ø§Ù„Ø³Ø¹Ø±: <b id="price">â€”</b></div>
        </div>
        <div class="hud2">
          <button class="btn primary" id="addCart">ğŸ›’ Ø¥Ø¶Ø§ÙØ© Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø©</button>
          <span class="chip">ØªÙ„Ù…ÙŠØ­: Ø¹Ù„Ù‰ Ø§Ù„Ø¬ÙˆØ§Ù„ Ø§Ø³ØªØ®Ø¯Ù… Pinch Ù„Ù„ØªÙ‚Ø±ÙŠØ¨</span>
        </div>
        <canvas id="c"></canvas>
      </div>

      <aside class="card pad">
        <div class="kicker">Ø§Ù„ØªØ®ØµÙŠØµ</div>
        <div class="title">Ù„ÙˆÙ† Ø§Ù„Ø¥Ø·Ø§Ø±</div>
        <div class="sub">Ø§Ø®ØªØ± Ù„ÙˆÙ†Ù‹Ø§ â€” ÙŠÙØ·Ø¨Ù‘Ù‚ ÙÙˆØ±Ù‹Ø§ Ø¹Ù„Ù‰ Ù†Ù…ÙˆØ°Ø¬ 3D.</div>
        <div class="hr"></div>
        <div class="colors" id="colors"></div>

        <div class="hr"></div>
        <div class="title" style="font-size:14px">Ø§Ù„Ø­Ø¬Ù…</div>
        <div class="sub">ØªØ­ÙƒÙ… Ø¨Ø­Ø¬Ù… Ø§Ù„Ø¹Ø±Ø¶ Ø¯Ø§Ø®Ù„ Ø§Ù„ØºØ±ÙØ©.</div>
        <input class="range" id="scale" type="range" min="0.7" max="1.6" step="0.01" value="1.0">

        <div class="hr"></div>
        <div class="note" id="offlineNote" style="display:none">
          ÙŠØ¨Ø¯Ùˆ Ø£Ù†Ùƒ ÙØªØ­Øª Ø§Ù„ØµÙØ­Ø© Ø¨Ø¯ÙˆÙ† Ø¥Ù†ØªØ±Ù†Øª.<br/>
          Ù‡Ø°Ù‡ Ø§Ù„ØºØ±ÙØ© ØªØ³ØªØ®Ø¯Ù… Three.js Ù…Ù† CDN ÙƒÙŠ ØªØ¹Ù…Ù„ Ø¹Ù„Ù‰ GitHub Pages. Ø§ÙØªØ­Ù‡Ø§ Ø¨Ø¹Ø¯ Ø§Ù„Ù†Ø´Ø± (Ø£ÙˆÙ†Ù„Ø§ÙŠÙ†) Ù„ØªØ´ØªØºÙ„ 3D Ø¨Ø´ÙƒÙ„ ÙƒØ§Ù…Ù„.
        </div>

        <div class="hr"></div>
        <div class="kicker">Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</div>
        <div class="sub" id="plist"></div>
      </aside>
    </section>
  </main>

  <div class="toast" id="toast">â€”</div>

<script type="module">
  const toastEl = document.getElementById('toast');
  function toast(m){toastEl.textContent=m;toastEl.style.display='block';clearTimeout(toast._t);toast._t=setTimeout(()=>toastEl.style.display='none',2200);}
  const catalog = [
    {id:'g1', name:'Ù†Ø¸Ø§Ø±Ø© Ø·Ø¨ÙŠØ© ÙƒÙ„Ø§Ø³ÙŠÙƒÙŠØ©', price:'520 Ø±.Ø³', kind:'optical'},
    {id:'g2', name:'Ù†Ø¸Ø§Ø±Ø© Ø·ÙŠØ±Ø§Ù† Ø´Ù…Ø³ÙŠØ©',   price:'690 Ø±.Ø³', kind:'sun'},
    {id:'g3', name:'Ù†Ø¸Ø§Ø±Ø© Ø¯Ø§Ø¦Ø±ÙŠØ© Ø·Ø¨ÙŠØ©',   price:'480 Ø±.Ø³', kind:'optical'},
    {id:'g4', name:'Ù†Ø¸Ø§Ø±Ø© Ù…Ø³ØªØ·ÙŠÙ„Ø© Ø´Ù…Ø³ÙŠØ©', price:'640 Ø±.Ø³', kind:'sun'},
    {id:'g5', name:'Ù†Ø¸Ø§Ø±Ø© Ø´ÙØ§ÙØ© Ø·Ø¨ÙŠØ©',    price:'450 Ø±.Ø³', kind:'optical'},
    {id:'g6', name:'Ù†Ø¸Ø§Ø±Ø© ÙØ§Ø®Ø±Ø© Ø´Ù…Ø³ÙŠØ©',   price:'880 Ø±.Ø³', kind:'sun'},
    {id:'g7', name:'Ù†Ø¸Ø§Ø±Ø© Ø´Ù…Ø³ÙŠØ© Ø¹Ø±ÙŠØ¶Ø©',   price:'720 Ø±.Ø³', kind:'sun'},
    {id:'g8', name:'Ù†Ø¸Ø§Ø±Ø© Ø´Ù…Ø³ÙŠØ© Ù…Ø³ØªØ¯ÙŠØ±Ø©', price:'610 Ø±.Ø³', kind:'sun'},
  ];
  const params = new URLSearchParams(location.search);
  const pid = params.get('product') || 'g1';
  let current = catalog.find(x=>x.id===pid) || catalog[0];

  document.getElementById('name').textContent = current.name;
  document.getElementById('price').textContent = current.price;

  document.getElementById('plist').innerHTML = catalog.map(p=>
    `<div style="display:flex;justify-content:space-between;align-items:center;gap:10px;margin:8px 0">
      <div><b>${p.name}</b><div class="kicker">${p.kind==='sun'?'Ø´Ù…Ø³ÙŠØ©':'Ø·Ø¨ÙŠØ©'} â€¢ ${p.price}</div></div>
      <a class="btn" href="room-eyewear.html?product=${p.id}">Ø¬Ø±Ù‘Ø¨Ù‡</a>
    </div>`
  ).join('');

  // Colors
  const colors = [
    {name:"Ø£Ø²Ø±Ù‚ ØºØ§Ù…Ù‚", c:"#0B2A4A"},
    {name:"Ø£Ø²Ø±Ù‚ ÙØ§ØªØ­", c:"#4DA3FF"},
    {name:"Ø£Ø³ÙˆØ¯", c:"#0B0B0F"},
    {name:"Ø°Ù‡Ø¨ÙŠ", c:"#C9A227"},
    {name:"ÙØ¶ÙŠ", c:"#94A3B8"},
    {name:"Ø£Ø¨ÙŠØ¶", c:"#FFFFFF"},
  ];
  const colorsEl = document.getElementById('colors');
  colorsEl.innerHTML = colors.map(x=>`<button class="cbtn" data-c="${x.c}" title="${x.name}" style="--c:${x.c}"></button>`).join('');
  function setActiveColor(hex){
    document.querySelectorAll('.cbtn').forEach(b=>b.classList.toggle('active', b.dataset.c===hex));
  }

  // Three.js (CDN) â€” works on GitHub Pages
  let THREE, OrbitControls;
  try{
    THREE = await import('https://unpkg.com/three@0.160.0/build/three.module.js');
    OrbitControls = (await import('https://unpkg.com/three@0.160.0/examples/jsm/controls/OrbitControls.js')).OrbitControls;
  }catch(e){
    document.getElementById('offlineNote').style.display='block';
    throw e;
  }

  const canvas = document.getElementById('c');
  const renderer = new THREE.WebGLRenderer({canvas, antialias:true, alpha:true});
  renderer.setPixelRatio(Math.min(devicePixelRatio, 2));

  const scene = new THREE.Scene();
  const camera = new THREE.PerspectiveCamera(50, 1, 0.1, 50);
  camera.position.set(0.0, 1.0, 3.0);

  const controls = new OrbitControls(camera, canvas);
  controls.enableDamping = true;
  controls.target.set(0, 0.2, 0);
  controls.minDistance = 1.6;
  controls.maxDistance = 5.2;

  // Lights
  scene.add(new THREE.HemisphereLight(0xffffff, 0x9bb7ff, 1.0));
  const dir = new THREE.DirectionalLight(0xffffff, 1.1);
  dir.position.set(3, 4, 2);
  scene.add(dir);

  // Ground hint
  const ground = new THREE.Mesh(
    new THREE.CircleGeometry(1.2, 64),
    new THREE.MeshStandardMaterial({color:0xffffff, roughness:0.9, metalness:0.0, transparent:true, opacity:0.55})
  );
  ground.rotation.x = -Math.PI/2;
  ground.position.y = -0.45;
  scene.add(ground);

  // Build simple but real 3D glasses (mesh)
  function buildGlasses(kind='optical'){
    const group = new THREE.Group();

    const frameMat = new THREE.MeshStandardMaterial({color:0x0B2A4A, roughness:0.35, metalness:0.25});
    const lensMat = new THREE.MeshPhysicalMaterial({
      color: kind==='sun' ? 0x111827 : 0x4DA3FF,
      roughness: 0.05,
      metalness: 0.0,
      transmission: 0.90,
      thickness: 0.12,
      transparent: true,
      opacity: kind==='sun' ? 0.50 : 0.25,
      ior: 1.45
    });

    const ringGeo = new THREE.TorusGeometry(0.42, 0.06, 18, 60);
    const leftRing = new THREE.Mesh(ringGeo, frameMat);
    leftRing.position.set(-0.55, 0.15, 0.0);
    group.add(leftRing);

    const rightRing = new THREE.Mesh(ringGeo, frameMat);
    rightRing.position.set(0.55, 0.15, 0.0);
    group.add(rightRing);

    const bridge = new THREE.Mesh(new THREE.CapsuleGeometry(0.07, 0.18, 10, 20), frameMat);
    bridge.rotation.z = Math.PI/2;
    bridge.position.set(0, 0.18, 0.05);
    group.add(bridge);

    const lensGeo = new THREE.CylinderGeometry(0.37, 0.37, 0.06, 48);
    const lensL = new THREE.Mesh(lensGeo, lensMat);
    lensL.rotation.x = Math.PI/2;
    lensL.position.set(-0.55, 0.15, 0.03);
    group.add(lensL);

    const lensR = lensL.clone();
    lensR.position.x = 0.55;
    group.add(lensR);

    const armGeo = new THREE.BoxGeometry(0.75, 0.07, 0.08);
    const armL = new THREE.Mesh(armGeo, frameMat);
    armL.position.set(-1.05, 0.14, -0.25);
    armL.rotation.y = 0.25;
    group.add(armL);

    const armR = armL.clone();
    armR.position.x = 1.05;
    armR.rotation.y = -0.25;
    group.add(armR);

    group.userData.frameMat = frameMat;
    return group;
  }

  let glasses = buildGlasses(current.kind);
  scene.add(glasses);

  function setFrameColor(hex){
    glasses.userData.frameMat.color.set(hex);
    setActiveColor(hex);
  }
  setFrameColor('#0B2A4A');

  document.querySelectorAll('.cbtn').forEach(b=>{
    b.addEventListener('click', ()=> setFrameColor(b.dataset.c));
  });

  // Scale
  const scaleEl = document.getElementById('scale');
  scaleEl.addEventListener('input', ()=>{
    const s = parseFloat(scaleEl.value);
    glasses.scale.setScalar(s);
  });

  // Cart
  let cart = 0;
  document.getElementById('addCart').addEventListener('click', ()=>{
    cart++; document.getElementById('cartCount').textContent = cart;
    toast('ğŸ›’ ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬ Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø©');
  });
  document.getElementById('cartBtn').addEventListener('click', ()=> toast('Ø§Ù„Ø³Ù„Ø© ÙˆÙ‡Ù…ÙŠØ© Ù„Ù„Ø¹Ø±Ø¶'));

  // Buttons
  let auto = true;
  document.getElementById('autoSpin').addEventListener('click', ()=>{auto=!auto; toast(auto?'ØªÙ… ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¯ÙˆØ±Ø§Ù†':'ØªÙ… Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø¯ÙˆØ±Ø§Ù†');});
  document.getElementById('reset').addEventListener('click', ()=>{
    controls.reset();
    glasses.rotation.set(0,0,0);
    glasses.scale.setScalar(parseFloat(scaleEl.value));
    toast('ØªÙ…Øª Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¶Ø¨Ø·');
  });
  document.getElementById('snap').addEventListener('click', ()=>{
    const a = document.createElement('a');
    a.download = 'veroom_eyewear_3d.png';
    a.href = canvas.toDataURL('image/png');
    a.click();
    toast('ØªÙ… Ø­ÙØ¸ Ù„Ù‚Ø·Ø©');
  });

  // Resize
  function resize(){
    const w = canvas.clientWidth, h = canvas.clientHeight;
    renderer.setSize(w, h, false);
    camera.aspect = w / Math.max(1, h);
    camera.updateProjectionMatrix();
  }
  window.addEventListener('resize', resize);
  resize();

  // Render loop
  function tick(){
    if(auto) glasses.rotation.y += 0.01;
    controls.update();
    renderer.render(scene, camera);
    requestAnimationFrame(tick);
  }
  tick();
</script>
</body>
</html>
